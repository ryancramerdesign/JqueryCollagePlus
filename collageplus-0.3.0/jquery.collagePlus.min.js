/*!
 *
 * jQuery collagePlus Plugin v0.3.0
 * https://github.com/ed-lea/jquery-collagePlus
 *
 * Copyright 2012, Ed Lea twitter.com/ed_lea
 *
 * built for http://qiip.me
 *
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 *
 */
;(function(e){e.fn.collagePlus=function(t){function r(t,n,r,s){var o=r.padding*(t.length-1)+t.length*t[0][3],u=r.albumWidth-o,a=u/(n-o),f=o;for(var l=0;l<t.length;l++){var c=e(t[l][0]),h=Math.floor(t[l][1]*a),p=Math.floor(t[l][2]*a),d=!!(l<t.length-1);f+=h;if(!d&&f<r.albumWidth){h=h+(r.albumWidth-f)}if(c.is("img")){c.width(h)}else{c.width(h+t[l][3]);c.find("img").width(h)}if(c.is("img")){c.height(p)}else{c.height(p+t[l][4]);c.find("img").height(p)}i(c,d,r);if(r.effect=="default"){c.animate({opacity:"1"},{duration:r.fadeSpeed})}else{if(r.direction=="vertical"){var v=s<=10?s:10}else{var v=l<=9?l+1:10}c.addClass(r.effect);c.addClass("effect-duration-"+v)}}}function i(e,t,n){var r={"margin-bottom":n.padding+"px","margin-right":t?n.padding+"px":"0px",display:n.display,"vertical-align":"bottom",overflow:"hidden"};return e.css(r)}function s(t){$img=e(t);var n=new Array;n["w"]=parseFloat($img.css("border-left-width"))+parseFloat($img.css("border-right-width"));n["h"]=parseFloat($img.css("border-top-width"))+parseFloat($img.css("border-bottom-width"));return n}var n=e.extend({targetHeight:400,albumWidth:this.width(),padding:parseFloat(this.css("padding-left")),images:this.children(),fadeSpeed:"fast",display:"inline-block",effect:"default",direction:"vertical"},t);return this.each(function(){var t=0,i=[],o=1;n.images.each(function(u){var a=e(this),f=a.is("img")?a:e(this).find("img");var l=typeof f.data("width")!="undefined"?f.data("width"):f.width(),c=typeof f.data("height")!="undefined"?f.data("height"):f.height();var h=s(f);f.data("width",l);f.data("height",c);var p=Math.ceil(l/c*n.targetHeight),d=Math.ceil(n.targetHeight);i.push([this,p,d,h["w"],h["h"]]);t+=p+h["w"]+n.padding;if(t>n.albumWidth&&i.length!=0){r(i,t-n.padding,n,o);delete t;delete i;t=0;i=[];o+=1}if(n.images.length-1==u&&i.length!=0){r(i,t,n,o);delete t;delete i;t=0;i=[];o+=1}})})}})(jQuery);